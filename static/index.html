<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- TODO: get a real favicon -->
    <!--<link rel="icon" href="/static/favicon.ico">-->

    <title>P.A.W.S.</title>

    <!-- Bootstrap core CSS -->
    <link href="/static/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="/static/assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/static/dashboard.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="/static/assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Highcharts -->
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
    <!--<script src="../highcharts/js/highcharts.js"></script>
    <script src="../highcharts/js/highstock.js"></script>
    <script src="../highcharts/js/modules/map.js"></script>
    <script type="text/javascript" src="../highcharts/js/themes/gray.js"></script>-->

  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">P.A.W.S.</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#">Dashboard</a></li>
            <li><a href="#">Settings</a></li>
            <li><a href="#">Profile</a></li>
            <li><a href="#">Help</a></li>
          </ul>
          <form class="navbar-form navbar-right">
            <input type="text" class="form-control" id ="searchbar" placeholder=" Search Dog Name">
            <button class="btn btn-round" type="button" onclick="search()">Search</button>
          </form>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
          <ul class="nav nav-sidebar">
            <li class="active"><a href="#">Overview <span class="sr-only">(current)</span></a></li>
            <li><a href="customChart.html">Custom Graphs</a></li>
            <li><a href="#">Analytics</a></li>
            <li><a href="#">Export</a></li>
          </ul>
          <ul class="nav nav-sidebar">
            <li><a href="">Nav item</a></li>
            <li><a href="">Nav item again</a></li>
            <li><a href="">One more nav</a></li>
            <li><a href="">Another nav item</a></li>
            <li><a href="">More navigation</a></li>
          </ul>
          <ul class="nav nav-sidebar">
            <li><a href="">Nav item again</a></li>
            <li><a href="">One more nav</a></li>
            <li><a href="">Another nav item</a></li>
          </ul>
        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <h1 class="page-header">Dashboard</h1>

          <div class="row placeholders">
            <div class="col-xs-6 col-sm-3 placeholder">
              <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Label</h4>
              <span class="text-muted">Something else</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Label</h4>
              <span class="text-muted">Something else</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Label</h4>
              <span class="text-muted">Something else</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Label</h4>
              <span class="text-muted">Something else</span>
            </div>
          </div>
          
          <!-- add a new dog -->
          
          <div class ="row">
            <div class="col-lg-12">
                
              <div class="x_title">
                <h4>Add a New Dog </h4>
                <div class="clearfix"></div>
              </div>
              <div class="x_content">
                Name:
                <input type="text" id="name" name="name" placeholder="Name" style="width: 4%;">

                ID:
                <input type="text" id="id" name="ID" placeholder="ID" style="width: 4%; ">

                Total Min:
                <input type="text" id="total" name="total" placeholder="Total" style="width: 4%; ">

                Active Min:
                <input type="text" id="active" name="active" placeholder="Active" style="width: 4%; ">

                Awake Min:
                <input type="text" id="awake" name="awake" placeholder="Awake" style="width: 4%;">

                Region:
                <input type="text" id="region" name="region" placeholder="Region" style="width: 4%; ">

                Job:
                <input type="text" id="job" name="job" placeholder="Job" style="width: 4%; ">

                Rest Min:
                <input type="text" id="rest" name="rest" placeholder="Rest" style="width: 4%; ">

                Tattoo:
                <input type="text" id="tattoo" name="tattoo" placeholder="Tattoo" style="width: 4%; ">
                <br><br>
                <button class="btn btn-round" type="button" onclick="add()">Add Dog</button>
                <br><br>
              </div>
            
            </div>
          </div>


          <!-- /add a new dog -->

          <h2 class="sub-header">Graphical Visualizations</h2>
        

          <div class="clearfix"></div>
            <div class ="row">
              <div id="result1" style="display:none" class="col-sm-12">
                  
                    <div class="x_title">
                      <h4>Results From Searchs <small>Lists of Recent Searches for Dogs in The Database</small></h4>
                      <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                      <p id="displayString"></p>
                    </div>
                  
                </div>
              </div>

          <!-- Highcharts -->

          <div class="container-fluid">
            <div class="col-md-12 col-sm-12 col-xs-12">
              <div id="chart1" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
            </div>
          </div>
          
<br><br>

          <div class="container-fluid">
            <div class="col-md-6 col-sm-6 col-xs-6">
              <div id="chart2" style="min-width: 310px; height: 400px; max-width: 800px; margin: 0 auto"></div>
            </div>

            <div class="col-md-6 col-sm-6 col-xs-6">
              <div id="chart5" style="min-width: 310px; height: 400px; max-width: 800px; margin: 0 auto"></div>
            </div>
          </div>
  
  <br><br>

          <div class="container-fluid">

            <div class="col-md-6 col-sm-6 col-xs-6">
              <div id="chart3" style="height: 400px; margin: auto; min-width: 310px; max-width: 600px"></div>
              <p>This graph is not using CCI's dog data but is however using a tutorial example from HighCharts to show the functionlity
                of boxplots and that we would have abililty to create them with the dog data.</p>
            </div>

            <div class="col-md-6 col-sm-6 col-xs-6">
              <div id="chart4" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
              <p>This graph is not using CCI's dog data but is however using a tutorial example from HighCharts to show the functionlity
                of being able to have combination data graphs. Since we do not yet have time data we held off on implementing this graph
                with CCI's data because for time efficieny purposes.</p>
            </div>

          </div>
          <!-- /Highcharts -->

          <div class="row"><!--row-->
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                  
                  <h4 align="center">Dog Activity Percentages</h4>
                  <div class="clearfix"></div>
                  
                  <div class="x_content">
                    <canvas id="lineChart"></canvas>
                    <p>Currently using percentages to showcase which dogs have been the most active regardless of the total amount of time. Some dogs have much high total time being recorded and strictly using raw minutes active will not indicate which dogs have been active most because newer dogs will have lower time active because they haven't had a large amount of total time.</p>
                  </div>
                </div>
            </div>
          </div><!--/row-->

          <div class="clearfix"></div>
          
          <div class="row"><!--row-->
            <div class="col-md-6 col-sm-6 col-xs-12">
              <div class="x_panel">
                
                <h4 align="center">Top 5 Resting Dogs</h4>
                <div class="clearfix"></div>
                
                <div class="x_content">
                  <canvas id="mybarChart"></canvas>
                </div>
              </div>
            </div> 

            <div class="col-md-6 col-sm-6 col-xs-12">
              <div class="x_panel">
                
                <h4 align="center">Rest VS Active</h4>
                <div class="clearfix"></div>
                
                <div class="x_content">
                  <canvas id="mybarChart1"></canvas>
                </div>
              </div>
            </div>
          </div><!--/row-->

        </div>
      </div>
    </div>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/static/assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="/static/dist/js/bootstrap.min.js"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
    <script src="/static/assets/js/vendor/holder.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="/static/assets/js/ie10-viewport-bug-workaround.js"></script>
    <script type="text/javascript" src="/static/charts.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script src="/static/Chart.js"></script>

    <!-- Chart.js graphs and search and add dog -->
    <script>
      
      var searched = [];
      var lineChart;
      var mybarChart;
      var mybarChart2;
      $.ajax({
                type: "GET",
                url: "/api/cached/data/filtered/dogs",
                async: true,
                datatype: 'json',
                success : function(data) {
                    store(data);
                    store1(data);
                    store2(data);
                    //console.log(string1);
                }
            });


           function store(data){
                var string1 = '';
                var arr = new Array(); 
                var arr1 = new Array(); 
                string1 = data;
                /*string1.sort = function(a, b) {
                    return (a.active/a.total) - (b.active/b.total);
                };*/

                for (var i =0; i < string1.length; i++) {
                   arr[i] = string1[i].name;
                   var ratio = string1[i].active / string1[i].total ;
                   arr1[i] = ratio * 100;
               };

                var ctx = document.getElementById("lineChart");
                lineChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                      labels: arr,
                      datasets: [{
                        label: "Percent of Total Time Active",
                        backgroundColor: "blue",
                        borderColor: "yellow",
                        pointBorderColor: "blue",
                        pointBackgroundColor: "yellow",
                        pointHoverBackgroundColor: "#fff",
                        pointHoverBorderColor: "rgba(220,220,220,1)",
                        pointBorderWidth: 1,
                        data: arr1
                      },]
                    }
                  });
           }

           function store1(data){
                var string1 = '';
                var arr = new Array(); 
                var arr1 = new Array(); 
                string1 = data;
                /*string1.sort = function(a, b){
                    return (a.rest/a.total) - (b.rest/b.total);
                };*/
                var j = 0;
                for (var i =string1.length - 5; i < string1.length; i++) {
                   arr[j] = string1[i].name;
                   var ratio = string1[i].rest / string1[i].total ;
                   arr1[j] = ratio * 100;
                   j++;
               };

                var ctx = document.getElementById("mybarChart");
                mybarChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                      labels: arr,
                      datasets: [{
                        label: 'Top Five Dogs With Highest % of Time Resting',
                        backgroundColor: "blue",
                        data: arr1
                      }]
                    },

                    options: {
                      scales: {
                        yAxes: [{
                          ticks: {
                            beginAtZero: true
                          }
                        }]
                      }
                    }
                });
           }

           function store2(data){
                var string1 = '';
                var arr = new Array(); 
                var arr1 = new Array(); 
                var arr2 = new Array();
                string1 = data;
                /*string1.sort = function(a, b){
                    return (a.active/a.total) - (b.active/b.total);
                };*/
                var j = 0;
                for (var i =string1.length - 10; i < string1.length; i++) {
                   arr[j] = string1[i].name;
                   var ratio = string1[i].active / string1[i].total ;
                   var ratio1 = string1[i].rest / string1[i].total ;
                   arr1[j] = ratio * 100;
                   arr2[j] = ratio1 * 100
                   j++;
               };

                var ctx = document.getElementById("mybarChart1");
                mybarChart2 = new Chart(ctx, {
                    type: 'bar',
                    data: {
                      labels: arr,
                      datasets: [{
                        label: 'Active Percent',
                        backgroundColor: "blue",
                        data: arr1
                      },{
                        label:'Rest Percent',
                        backgroundColor: "yellow",
                        data:arr2
                        }]
                    },

                    options: {
                      scales: {
                        yAxes: [{
                          ticks: {
                            beginAtZero: true
                          }
                        }]
                      }
                    }
                });
            }

            function search(){
              var name = document.getElementById("searchbar").value;
              var e = document.getElementById("result1");
              //console.log(string1);
              string1.sort(function(a, b){
                    return b.name < a.name ?  1 // if b should come earlier, push a to end
                          : b.name > a.name ? -1 // if b should come later, push a to begin
                          : 0;
                });
              var string2 = string1;
              //console.log(string1);
              if(!searched.includes(name)){
                var x1 = binarySearch(string2, name);
                console.log(x1);
                if(x1 != false){
                  var info = "name: " + x1.name + " , id: " + x1.id + " , minutes active: " + x1.active + " , minutes resting: " + x1.rest + " , minutes awake: " + x1.awake + " , tattoo number: " + x1.tattoo_number;
                  e.style.display ='block';
                  var mydiv = document.getElementById("displayString");
                  mydiv.appendChild(document.createTextNode(info));
                  mydiv.innerHTML+= '<br>';
                  searched.push(name);
                }
              }
              

            }

            function binarySearch(arr, i){
              var len1 = arr.length;
              for (var i1 = 0; i1 < len1; i1++) {
                  
                  var name = arr[i1].name.toString();
                  console.log(name);
                  if (name.indexOf(i.toString()) >= 0){
                    return arr[i1];
                  } else {
                    console.log(name.indexOf(i.toString()));
                  }
              };
              return false;
            }

            function add(){
              var name1 = document.getElementById("name").value;
              var job = document.getElementById("job").value;
              var region = document.getElementById("region").value;
              var awake1 = Number(document.getElementById("awake").value);
              var tattoo = Number(document.getElementById("tattoo").value);
              var rest = Number(document.getElementById("rest").value);
              var active1 = Number(document.getElementById("active").value);
              var id1 = Number(document.getElementById("id").value);
              var total = Number(document.getElementById("total").value);
              console.log(name1);
              if(name1 == '' || awake1 < 0 || tattoo < 0 || rest < 0 || active1 < 0 || id1 < 0|| total < 0){
                alert("Please add at least a name for the dog. All other attributes default to 0 if empty.");
              } else {
                var dog = {
                  "active": active1,
                  "awake": awake1,
                  "id": id1,
                  "job": job,
                  "name": name1,
                  "region": region,
                  "rest": rest,
                  "tattoo_number": tattoo,
                  "total": total
                };
                string1.push(dog);
                lineChart.destroy();
                store(string1);
                mybarChart.destroy();
                store1(string1);
                mybarChart2.destroy();
                store2(string1);
                
              }
            }      
  </script>

  </body>
</html>
